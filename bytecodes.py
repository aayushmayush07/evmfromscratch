# bytecodes.py

# -------------------- ADD --------------------

SIMPLE_ADD      = [0x60, 0x42, 0x60, 0xFF, 0x01]  #66+255=321

ADD_OVERFLOW    = [0x7F] + [0xFF]*32 + [0x60, 0x01, 0x01]
# (2^256-1 + 1) mod 2^256 = 0


# -------------------- SUB --------------------

SIMPLE_SUB      = [0x60, 0x05, 0x60, 0x10, 0x03]
#  16 - 5 = 11

SUB_UNDERFLOW   = [0x60, 0xFF, 0x60, 0x0F, 0x03]
#15 - 255 = -240 mod 2^256


# -------------------- MUL --------------------

SIMPLE_MUL      = [0x60, 0x14, 0x60, 0x0A, 0x02]
# 20*10=200

MUL_BY_ZERO     = [0x60, 0x42, 0x60, 0x00, 0x02]
#  66*0 = 0

MUL_BY_ONE      = [0x60, 0x42, 0x60, 0x01, 0x02]
# 66*1=66

MUL_BIG_SMALL   = [0x60, 0x02, 0x7F] + [0xFF]*32 + [0x02]
# (2^256-1)*2 = 2^257-2 ≡ 2^256-2

MUL_MAX         = [0x7F] + [0xFF]*32 + [0x7F] + [0xFF]*32 + [0x02]
# (2^256-1)*(2^256-1) = 2^512 - 2^257 + 1 → mod 2^256 = 1


# -------------------- DIV --------------------

SIMPLE_DIV      = [0x60, 0x0A, 0x60, 0x64, 0x04]
#  100 / 10 = 10

DIV_BY_ZERO     = [0x60, 0x00, 0x60, 0x02, 0x04]
# 2/0 = 0


# -------------------- SDIV --------------------

SIMPLE_SDIV     = [0x60, 0x02, 0x60, 0x0A, 0x05]
#  signed 10/2 = 5

SDIV_ZERO       = [0x60, 0x00, 0x60, 0x0A, 0x05]
#division by 0 = 0

SDIV_NEG_POS    = [0x60, 0x05, 0x7F] + [0xFF]*32 + [0x05]
# (-1)/5 = 0 (truncates toward 0)


# -------------------- MOD --------------------

SIMPLE_MOD      = [0x60, 0x05, 0x60, 0x0D, 0x06]
# 13 % 5 = 3


# -------------------- EXP --------------------

SIMPLE_EXP      = [0x60, 0x05, 0x60, 0x02, 0x0A]
#2**5=32

EXP_ZERO = [0x60, 0x00, 0x60, 0x05, 0x0A]   #5^0=1
EXP_OVERFLOW = [0x60, 0xFF, 0x60, 0x02, 0x0A]  #2^255 mod 2^256



ADDMOD_SIMPLE = [0x60, 0x07, 0x60, 0x05, 0x60, 0x03, 0x08]
ADDMOD_ZERO_MOD = [0x60, 0x00, 0x60, 0x07, 0x60, 0x05, 0x08]
ADDMOD_OVERFLOW_10 = [0x60, 0x0A, 0x7F] + [0xFF]*32 + [0x60, 0x01, 0x08]